Tag and probe code inherited from Kevin Sung.
