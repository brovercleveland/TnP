Tag and probe code inherited from Kevin Sung.  Double free seg fault during cleanup also inherited from Kevin.
